import{c as p,i as u}from"./version-Ceh7G5a-.js";import"./mobileMenu-Y-8SxjNx.js";import"./full-width-CrKHpSp0.js";import"./simple-mode-footer-taxVzkwL.js";import{k as m,f as v,l as w,r as E,d as L,m as b}from"./main-BBpb6J13.js";import{P as B}from"./PDFButton-BRxkI6_c.js";import"./index-DMQTJy3b.js";let s=[];document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();function g(){p({icons:u});const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),n=document.getElementById("add-more-btn"),r=document.getElementById("clear-files-btn"),a=document.getElementById("process-btn");e&&e.addEventListener("change",I),t&&(t.addEventListener("dragover",o=>{o.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-gray-700")}),t.addEventListener("drop",o=>{o.preventDefault(),t.classList.remove("bg-gray-700");const i=o.dataTransfer?.files;i&&i.length>0&&h(i)}),e?.addEventListener("click",()=>{e&&(e.value="")})),n&&n.addEventListener("click",()=>{e?.click()}),r&&r.addEventListener("click",()=>{s=[],f()}),a&&a.addEventListener("click",P),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="/"})}function I(e){const t=e.target;t.files&&t.files.length>0&&h(t.files)}function h(e){const t=Array.from(e).filter(n=>n.type==="image/jpeg"||n.type==="image/jpg"||n.name.toLowerCase().endsWith(".jpg")||n.name.toLowerCase().endsWith(".jpeg"));t.length<e.length&&m("Invalid Files","Some files were skipped. Only JPG/JPEG images are allowed."),t.length>0&&(s=[...s,...t],f())}const x=()=>{s=[],f()};function f(){const e=document.getElementById("file-display-area"),t=document.getElementById("file-controls"),n=document.getElementById("jpg-to-pdf-options");!e||!t||!n||(e.innerHTML="",s.length>0?(t.classList.remove("hidden"),n.classList.remove("hidden"),s.forEach((r,a)=>{const o=document.createElement("div");o.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const i=document.createElement("div");i.className="flex items-center gap-2 overflow-hidden";const d=document.createElement("span");d.className="truncate font-medium text-gray-200",d.textContent=r.name;const c=document.createElement("span");c.className="flex-shrink-0 text-gray-400 text-xs",c.textContent=`(${v(r.size)})`,i.append(d,c);const l=document.createElement("button");l.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",l.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',l.onclick=()=>{s=s.filter((C,y)=>y!==a),f()},o.append(i,l),e.appendChild(o)}),p({icons:u})):(t.classList.add("hidden"),n.classList.add("hidden")))}function k(e){return new Promise((t,n)=>{const r=new Blob([e]),a=URL.createObjectURL(r),o=new Image;o.onload=()=>{const i=document.createElement("canvas");i.width=o.naturalWidth,i.height=o.naturalHeight,i.getContext("2d").drawImage(o,0,0),i.toBlob(async c=>{if(!c)return n(new Error("Canvas toBlob conversion failed."));const l=await c.arrayBuffer();t(new Uint8Array(l))},"image/jpeg",.9),URL.revokeObjectURL(a)},o.onerror=()=>{URL.revokeObjectURL(a),n(new Error("The provided file could not be loaded as an image. It may be corrupted."))},o.src=a})}async function P(){if(s.length===0){m("No Files","Please select at least one JPG file.");return}w("Creating PDF from JPGs...");try{const e=await B.create();for(const n of s){const r=await E(n);let a;try{a=await e.embedJpg(r)}catch{m("Warning",`Direct JPG embedding failed for ${n.name}, attempting to sanitize...`);try{const d=await k(r);a=await e.embedJpg(d)}catch(d){throw console.error(`Failed to process ${n.name} after sanitization:`,d),new Error(`Could not process "${n.name}". The file may be corrupted.`)}}e.addPage([a.width,a.height]).drawImage(a,{x:0,y:0,width:a.width,height:a.height})}const t=await e.save();L(new Blob([new Uint8Array(t)],{type:"application/pdf"}),"from_jpgs.pdf"),m("Success","PDF created successfully!","success",()=>{x()})}catch(e){console.error(e),m("Conversion Error",e.message)}finally{b()}}
